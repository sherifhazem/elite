
# Observability System — ELITE Project

## 1. Purpose of This Document
This document defines the **centralized and simplified observability system** used in the ELITE project.

It exists to ensure that:
- Monitoring remains centralized, predictable, and maintainable.
- No logging logic appears inside routes, services, modules, or JS files.
- AI agents understand exactly how observability works and how to extend or maintain it.
- The system avoids unnecessary complexity and prevents architectural drift.
- All observability behavior remains documented, explicit, and stable.

---

# 2. Observability Philosophy

The ELITE project uses a **minimalist, centralized, non-intrusive** observability model.

This means:

1. Logging is activated only at one single point (`app/__init__.py`).  
2. No module or service interacts directly with the logging system.  
3. No distributed JS or request-level instrumentation exists.  
4. The system tracks what is useful — and nothing more.  
5. Logs remain local and stored as JSON files.  

This approach guarantees:
- Zero structural overhead  
- Zero code duplication  
- Zero pollution inside feature modules  
- Easy debugging without complexity  

---

# 3. Observability Components

The observability layer consists of only **three files** inside:

app/core/

### 3.1 `central_logger.py`
Purpose:
- Provides a unified logger that outputs structured JSON logs.

Responsibilities:
- Create a logger object.
- Define log format (JSON only).
- Provide simple log levels: info, warning, error.
- Write logs to:

/logs/app.log.json

- Ensure safe file writing.

### 3.2 `central_middleware.py`
Purpose:
- Middleware-based request tracking.

Responsibilities:
- Generate `request_id` for every incoming request.
- Store the ID in `g.request_id` for the request lifecycle.
- Add the ID to the response headers.
- Log:
- Request start
- Request end
- Processing duration
- Unhandled errors

### 3.3 `__init__.py` (Activation Point)
Purpose:
- Activates logging and middleware.

Responsibilities:
- Import and register the middleware.
- Initialize the logger.
- Ensure all modules automatically follow the global logging policy.

There is **no logging code** inside:
- Routes  
- Services  
- Modules  
- Templates  
- Static files  
- Tools scripts  

---

# 4. Log Format

All logs generated by the system must follow the unified structure:

```json
{
"timestamp": "2025-01-01T12:00:00Z",
"level": "INFO or ERROR",
"request_id": "unique-id",
"path": "/current/request/path",
"method": "GET or POST",
"duration_ms": 24,
"message": "Description of event",
"details": { "optional_metadata": "values" }
}

Rules:

JSON only

No plain text logs

No fragmented file formats

No external logging systems



---

5. Logging Behavior

5.1 Request Lifecycle Logging

Each request automatically logs:

Request start

Request end

HTTP method

Path

Duration

Any unhandled error


5.2 Error Logging

Unhandled errors automatically produce:

error-level logs

stack information (sanitized)

request ID

path


5.3 No Additional Logging Allowed

To avoid complexity:

Modules must not log

Services must not log

JS front-end must not log

Routes must not call the logger


All logging belongs inside:

app/core/central_logger.py
app/core/central_middleware.py


---

6. Directory Structure for Observability

app/core/
    central_logger.py          # Global JSON logger
    central_middleware.py      # Centralized request tracking middleware
    database.py                # Unrelated, but kept here for context

Logs directory:

/logs/
    app.log.json

All logs go into a single file.


---

7. What Is Explicitly NOT Part of the System

To prevent AI agents from adding unwanted complexity,
the following features are NOT part of the observability system:

❌ No per-module logging
❌ No service-level logging
❌ No distributed JS tracking
❌ No API wrappers
❌ No frontend instrumentation
❌ No analytics dashboards
❌ No external tools (Sentry / Prometheus / ELK / Loki / Datadog)
❌ No metrics or event pipelines
❌ No tracing systems

If any of these are required in the future,
they must be requested explicitly.


---

8. Maintenance Rules for AI Agents

When updating or modifying the observability logic:

AI agents must:

1. Modify files only inside:

app/core/


2. Keep logging centralized and minimal.


3. Avoid adding logging code anywhere else.


4. Preserve the unified JSON log format.


5. Update this file if:

Log structure changes

The logger gains new capabilities

Middleware behavior changes



6. Update CHANGELOG.md for every change.


7. Ask for clarification before introducing new observability features.



AI agents must NOT:

Create a new logging system.

Introduce distributed tracking.

Add logging inside modules.

Modify module files to support observability.

Add metrics, traces, or analytics.

Introduce external libraries for logging.



---

9. Future Planned Enhancements

The only approved future improvements are:

Adding optional simple log rotation.

Adding environment-based log levels.

Adding configurable log file paths via config/.


Any other feature must be explicitly requested.


---

10. Summary

The observability layer in ELITE is intentionally:

Simple

Centralized

Maintainable

AI-friendly

Non-intrusive


All logging is activated from app/__init__.py
and implemented only in the core layer.

This document must be updated with every modification
to maintain a clear and predictable behavior for the system.