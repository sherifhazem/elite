{% extends "admin/dashboard/admin_base.html" %}
{% set active_page = 'settings' %}

{% block content %}
<div class="container-fluid py-4" id="admin-settings-root">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3 mb-4">
        <div>
            <h1 class="h3 mb-1">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©</h1>
            <p class="text-muted mb-0">
                ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø¯Ù† ÙˆÙ…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ.
                Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ÙÙˆØ±ÙŠØ© ÙˆØªÙ†Ø¹ÙƒØ³ Ø¹Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª.
            </p>
        </div>
        <div class="text-md-end text-muted small">
            <span class="d-block">Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„.</span>
            <span>ÙŠØ­ÙØ¸ ÙƒÙ„ ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© Ù„Ù„Ø³Ø¬Ù„.</span>
        </div>
    </div>

    <ul class="nav nav-pills admin-pills">
        <li class="nav-item">
            <a
                class="nav-link {{ 'active' if selected_tab == 'cities' else '' }}"
                href="{{ url_for('admin.settings_home', tab='cities') }}"
            >
                Ø§Ù„Ù…Ø¯Ù†
            </a>
        </li>
        <li class="nav-item">
            <a
                class="nav-link {{ 'active' if selected_tab == 'industries' else '' }}"
                href="{{ url_for('admin.settings_home', tab='industries') }}"
            >
                Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„
            </a>
        </li>
    </ul>

    <div class="tab-content mt-4">
        <div class="tab-pane fade {{ 'show active' if selected_tab == 'cities' else '' }}" id="settings-cities" role="tabpanel">
            <div class="card shadow-sm admin-card mb-4">
                <div class="card-header d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3">
                    <div>
                        <h2 class="h5 mb-0">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ù†</h2>
                        <span class="text-muted small">ÙŠØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª.</span>
                    </div>
                    <form class="d-flex gap-2 flex-wrap align-items-center js-add-form" data-list-type="cities" action="{{ url_for('admin.add_city') }}" method="post">
                        <label class="visually-hidden" for="add-city-input">Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø¯ÙŠØ¯Ø©</label>
                        <input class="form-control" id="add-city-input" name="name" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø¯ÙŠØ¯Ø©" required>
                        <button class="btn btn-primary" type="submit">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¯ÙŠÙ†Ø©</button>
                    </form>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger d-none" role="alert" data-feedback="cities"></div>
                    <div class="table-responsive">
                        <table class="table align-middle mb-0">
                            <thead>
                                <tr>
                                    <th scope="col">Ø§Ù„Ø§Ø³Ù…</th>
                                    <th scope="col" class="text-end">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody data-list-table="cities">
                                {% if cities %}
                                    {% for city in cities %}
                                        <tr data-value="{{ city }}">
                                            <td class="fw-medium">{{ city }}</td>
                                            <td class="text-end">
                                                <div class="btn-group" role="group">
                                                    <button
                                                        class="btn btn-sm btn-outline-primary js-edit-item"
                                                        type="button"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#editItemModal"
                                                        data-list-type="cities"
                                                        data-current-value="{{ city }}"
                                                    >
                                                        âœï¸ ØªØ¹Ø¯ÙŠÙ„
                                                    </button>
                                                    <button
                                                        class="btn btn-sm btn-outline-danger js-delete-item"
                                                        type="button"
                                                        data-list-type="cities"
                                                        data-value="{{ city }}"
                                                    >
                                                        ğŸ—‘ Ø­Ø°Ù
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr class="js-empty-row" data-list-type="cities">
                                        <td colspan="2" class="text-center text-muted py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯Ù† Ù…Ø³Ø¬Ù„Ø©.</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade {{ 'show active' if selected_tab == 'industries' else '' }}" id="settings-industries" role="tabpanel">
            <div class="card shadow-sm admin-card mb-4">
                <div class="card-header d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3">
                    <div>
                        <h2 class="h5 mb-0">Ù‚Ø§Ø¦Ù…Ø© Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„</h2>
                        <span class="text-muted small">ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ.</span>
                    </div>
                    <form class="d-flex gap-2 flex-wrap align-items-center js-add-form" data-list-type="industries" action="{{ url_for('admin.add_industry') }}" method="post">
                        <label class="visually-hidden" for="add-industry-input">Ù…Ø¬Ø§Ù„ Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯</label>
                        <input class="form-control" id="add-industry-input" name="name" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¬Ø§Ù„ Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯" required>
                        <button class="btn btn-primary" type="submit">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ø§Ù„</button>
                    </form>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger d-none" role="alert" data-feedback="industries"></div>
                    <div class="table-responsive">
                        <table class="table align-middle mb-0">
                            <thead>
                                <tr>
                                    <th scope="col">Ø§Ù„Ø§Ø³Ù…</th>
                                    <th scope="col" class="text-end">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody data-list-table="industries">
                                {% if industries %}
                                    {% for industry in industries %}
                                        <tr data-value="{{ industry }}">
                                            <td class="fw-medium">{{ industry }}</td>
                                            <td class="text-end">
                                                <div class="btn-group" role="group">
                                                    <button
                                                        class="btn btn-sm btn-outline-primary js-edit-item"
                                                        type="button"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#editItemModal"
                                                        data-list-type="industries"
                                                        data-current-value="{{ industry }}"
                                                    >
                                                        âœï¸ ØªØ¹Ø¯ÙŠÙ„
                                                    </button>
                                                    <button
                                                        class="btn btn-sm btn-outline-danger js-delete-item"
                                                        type="button"
                                                        data-list-type="industries"
                                                        data-value="{{ industry }}"
                                                    >
                                                        ğŸ—‘ Ø­Ø°Ù
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr class="js-empty-row" data-list-type="industries">
                                        <td colspan="2" class="text-center text-muted py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¬Ø§Ù„Ø§Øª Ø¹Ù…Ù„ Ù…Ø³Ø¬Ù„Ø©.</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù†ØµØ± -->
<div
    class="modal fade"
    id="editItemModal"
    tabindex="-1"
    aria-labelledby="editItemModalLabel"
    aria-hidden="true"
    data-update-city-action="{{ url_for('admin.update_city') }}"
    data-update-industry-action="{{ url_for('admin.update_industry') }}"
>
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editItemModalLabel">ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù†ØµØ±</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="post" id="editItemForm">
                <div class="modal-body">
                    <input type="hidden" name="current_value" id="editCurrentValue">
                    <div class="mb-3">
                        <label class="form-label" for="editItemName">Ø§Ù„Ø§Ø³Ù…</label>
                        <input class="form-control" id="editItemName" name="name" type="text" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary" id="editItemSubmit">Ø­ÙØ¸</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
    {{ super() }}
    <script id="admin-settings-context" type="application/json">
        {{ {
            "selected_tab": selected_tab,
            "cities": cities,
            "industries": industries,
            "endpoints": {
                "add_city": url_for('admin.add_city'),
                "add_industry": url_for('admin.add_industry'),
                "update_city": url_for('admin.update_city'),
                "update_industry": url_for('admin.update_industry'),
                "delete_city": url_for('admin.delete_city'),
                "delete_industry": url_for('admin.delete_industry'),
            },
        } | tojson }}
    </script>
    <script src="{{ url_for('static', filename='admin/js/settings.js') }}" defer></script>
{% endblock %}
