{% extends "admin/dashboard/admin_base.html" %}
{% block title %}Company Details{% endblock %}

{% block content %}
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold">{{ company.name }}</h2>
    <a href="{{ url_for('admin.list_companies') }}" class="btn btn-outline-secondary btn-sm">← Back</a>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="mb-3">Company Information</h5>

      <div class="row">
        <div class="col-md-6">
          <p><strong>Email:</strong> {{ company.email or '—' }}</p>
          <p><strong>Phone:</strong> {{ company.contact_number or '—' }}</p>
          <p><strong>City:</strong> {{ company.city or '—' }}</p>
          <p><strong>Industry:</strong> {{ company.industry or '—' }}</p>
        </div>

        <div class="col-md-6">
          <p><strong>Website:</strong>
            {% if company.website_url %}
              <a href="{{ company.website_url }}" target="_blank">{{ company.website_url }}</a>
            {% else %}
              —
            {% endif %}
          </p>
          <p><strong>Social Link:</strong>
            {% if company.social_url %}
              <a href="{{ company.social_url }}" target="_blank">{{ company.social_url }}</a>
            {% else %}
              —
            {% endif %}
          </p>
          <p><strong>Status:</strong>
            <span class="badge bg-secondary text-uppercase">{{ company.status }}</span>
          </p>
        </div>
      </div>
    </div>
  </div>

  {% if company.admin_notes %}
  <div class="card shadow-sm">
    <div class="card-body">
      <h5 class="mb-2">Admin Notes</h5>
      <p class="text-muted mb-0">{{ company.admin_notes }}</p>
    </div>
  </div>
  {% endif %}

  <div class="card shadow-sm mt-4">
    <div class="card-body d-flex flex-wrap gap-2 align-items-center">
      <h5 class="mb-0 me-3">Status Actions</h5>

      {% if company.status in ['pending', 'correction'] %}
        <form method="post" action="{{ url_for('admin.approve_company', company_id=company.id) }}" class="d-inline">
          <button type="submit" class="btn btn-success">Accept Company</button>
        </form>
      {% endif %}

      {% if company.status == 'approved' %}
        <form method="post" action="{{ url_for('admin.suspend_company', company_id=company.id) }}" class="d-inline">
          <button type="submit" class="btn btn-warning">Suspend</button>
        </form>
      {% elif company.status == 'suspended' %}
        <form method="post" action="{{ url_for('admin.reactivate_company', company_id=company.id) }}" class="d-inline">
          <button type="submit" class="btn btn-success">Reactivate</button>
        </form>
      {% endif %}
    </div>
  </div>

  <div class="card shadow-sm mt-4">
    <div class="card-body">
      <h5 class="mb-3">Request Missing/Corrected Details</h5>
      <form method="post" action="{{ url_for('admin.request_company_correction', company_id=company.id) }}">
        <div class="mb-3">
          <label for="correction_notes" class="form-label">Message to Company</label>
          <textarea class="form-control" id="correction_notes" name="correction_notes" rows="4"
            placeholder="Describe the missing or incorrect information to complete the review." required></textarea>
          <div class="form-text">This note will be emailed to the company contact.</div>
        </div>
        <button type="submit" class="btn btn-warning">Send Correction Request</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
