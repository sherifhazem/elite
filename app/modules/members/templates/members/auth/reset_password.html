{% extends "members/auth/base_auth.html" %}
{% block title %}إعادة تعيين كلمة المرور | ELITE{% endblock %}

{% block content %}
<div class="auth-shell">
  <div class="auth-card">
    <div class="auth-card__header">
      <div class="auth-icon">
        <i class="fa-solid fa-shield-keyhole fa-3x"></i>
      </div>
      <h2 class="auth-title">تعيين كلمة مرور جديدة</h2>
      <p class="auth-subtitle">أدخل كلمة مرور جديدة لحسابك.</p>
    </div>

    <div class="auth-card__body">
      {% if token_error %}
      <div class="alert alert-warning text-center" role="alert">
        {{ token_error }}
        <div class="mt-2">
          <a href="{{ url_for('auth.forgot_password') }}" class="ghost-button ghost-button--small auth-ghost">
            طلب رابط جديد
          </a>
        </div>
      </div>
      {% else %}
      <form id="reset-password-form" novalidate data-reset-endpoint="{{ url_for('auth.reset_password', token=token) }}"
        data-login-url="{{ url_for('auth.login') }}">
        <div class="auth-field">
          <label for="new_password" class="auth-field__label">كلمة المرور الجديدة</label>
          <div class="auth-field__input">
            <input type="password" id="new_password" name="new_password" class="form-control auth-input"
              placeholder="••••••••" autocomplete="new-password" dir="ltr" required minlength="8" />
          </div>
        </div>

        <div class="auth-field">
          <label for="confirm_password" class="auth-field__label">تأكيد كلمة المرور</label>
          <div class="auth-field__input">
            <input type="password" id="confirm_password" name="confirm_password" class="form-control auth-input"
              placeholder="••••••••" autocomplete="new-password" dir="ltr" required minlength="8" />
            <div class="form-text mt-1">يجب أن تتطابق كلمتا المرور.</div>
          </div>
        </div>


        <div id="reset-feedback" class="small mb-3" role="alert"></div>

        <button type="submit" id="reset-submit" class="btn btn-gradient w-100 py-2">
          حفظ كلمة المرور
        </button>

        <div class="auth-footer mt-4">
          <a href="{{ url_for('auth.login') }}" class="ghost-button ghost-button--small auth-ghost">
            العودة لتسجيل الدخول
          </a>
        </div>
      </form>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
{% if not token_error %}
<script src="{{ url_for('static', filename='members/js/auth_reset_password_form.js') }}" defer></script>
{% endif %}
{% endblock %}