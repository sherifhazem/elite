{% extends "members/auth/base_auth.html" %}
{% block title %}إعادة تعيين كلمة المرور | ELITE{% endblock %}

{% block content %}
<div class="auth-card mx-auto" style="max-width: 440px;">
  <div class="text-center mb-4">
    <div class="mb-3">
      <i class="fa-solid fa-shield-keyhole fa-3x text-gradient"></i>
    </div>
    <h2 class="fw-bold mb-2" style="color: var(--brand-primary);">تعيين كلمة مرور جديدة</h2>
    <p class="text-muted mb-0">أدخل كلمة مرور جديدة لحسابك.</p>
  </div>

  {% if token_error %}
    <div class="alert alert-warning text-center" role="alert">
      {{ token_error }}
      <div class="mt-2">
        <a href="{{ url_for('auth.forgot_password') }}" class="text-decoration-none">طلب رابط جديد</a>
      </div>
    </div>
  {% else %}
    <form
      id="reset-password-form"
      novalidate
      data-reset-endpoint="{{ url_for('auth.reset_password', token=token) }}"
      data-login-url="{{ url_for('auth.login') }}"
    >
      <div class="mb-3 text-start">
        <label for="new_password" class="form-label">كلمة المرور الجديدة</label>
        <input
          type="password"
          id="new_password"
          name="new_password"
          class="form-control auth-input"
          placeholder="••••••••"
          autocomplete="new-password"
          required
          minlength="8"
        />
      </div>

      <div class="mb-3 text-start">
        <label for="confirm_password" class="form-label">تأكيد كلمة المرور</label>
        <input
          type="password"
          id="confirm_password"
          name="confirm_password"
          class="form-control auth-input"
          placeholder="••••••••"
          autocomplete="new-password"
          required
          minlength="8"
        />
        <div class="form-text">يجب أن تتطابق كلمتا المرور.</div>
      </div>

      <div id="reset-feedback" class="small" role="alert"></div>

      <button type="submit" id="reset-submit" class="btn btn-gradient w-100 py-2">
        حفظ كلمة المرور
      </button>

      <div class="text-center mt-4">
        <a href="{{ url_for('auth.login') }}" class="fw-semibold text-decoration-none text-primary">
          العودة لتسجيل الدخول
        </a>
      </div>
    </form>
  {% endif %}
</div>
{% endblock %}

{% block extra_scripts %}
  {% if not token_error %}
    <script src="{{ url_for('static', filename='members/js/auth_reset_password_form.js') }}" defer></script>
  {% endif %}
{% endblock %}
