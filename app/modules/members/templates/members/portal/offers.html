<!-- LINKED: Shared Offers & Redemptions Integration (no schema changes) -->
<!-- FIXED: Mobile-First User Portal Design (Member-Only) -->
<!-- UI SYNC: Offer design unified across Home and Offers views -->
{% extends 'members/portal/base.html' %}
{% block title %}العروض · ELITE{% endblock %}
{% from 'members/portal/components/offer_card_macro.html' import render_offer_card %}
{% block page_heading %}العروض{% endblock %}
{% block content %}
<section class="offers-header">
    <h1 class="offers-header__title">العروض</h1>
    <div class="home-search offers-search" role="search">
        <label class="visually-hidden" for="offers-search-input">البحث</label>
        <input class="home-search__input" id="offers-search-input" type="search" name="q"
            placeholder="ابحث باسم الشريك أو التصنيف" autocomplete="off" />
    </div>
    {% if offers %}
    {% set ns = namespace(categories=[]) %}
    {% for offer in offers %}
    {% if offer.category is defined and offer.category %}
    {% set category_name = offer.category.name if offer.category.name is defined else offer.category %}
    {% if category_name not in ns.categories %}
    {% set _ = ns.categories.append(category_name) %}
    {% endif %}
    {% endif %}
    {% endfor %}
    <div class="offers-chips" role="list" aria-label="تصنيفات العروض">
        <button class="offers-chip offers-chip--active" type="button" data-filter="all">الكل</button>
        {% for category in ns.categories %}
        <button class="offers-chip" type="button" data-filter="{{ category|e }}">{{ category }}</button>
        {% endfor %}
    </div>
    {% endif %}
    <button class="offers-filter" type="button" role="button" aria-label="فلترة العروض">
        <span class="offers-filter__icon" aria-hidden="true"><i class="fa-solid fa-filter"></i></span>
        <span>فلترة</span>
    </button>
</section>
<section class="offers-body">
    {% if offers %}
    <div class="offers-grid" role="list">
        {% for offer in offers %}
        {% set runtime = offer_runtime_flags.get(offer.id, {}) %}
        {{ render_offer_card(offer, show_runtime_status=True, runtime_flags=runtime) }}
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <p>لا توجد عروض متاحة حالياً. سيتم إعلامك فور توفر عروض جديدة.</p>
    </div>
    {% endif %}
</section>
{% endblock %}