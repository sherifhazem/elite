<!-- LINKED: Shared Offers & Redemptions Integration (no schema changes) -->
<!-- FIXED: Mobile-First User Portal Design (Member-Only) -->
<!-- UI SYNC: Offer design unified across Home and Offers views -->
{% extends 'members/portal/base.html' %}
{% block title %}العروض · ELITE{% endblock %}
{% from 'members/portal/components/offer_card_macro.html' import render_offer_card %}
{% block page_heading %}العروض{% endblock %}
{% block content %}
<section class="offers-header">
    <div class="home-search offers-search" role="search">
        <label class="visually-hidden" for="offers-search-input">البحث</label>
        <i class="fa-solid fa-magnifying-glass search-icon"></i>
        <input class="home-search__input" id="offers-search-input" type="search" name="q"
            placeholder="ابحث باسم الشريك أو التصنيف" autocomplete="off" />
    </div>
    {% if offers %}
    {% set ns = namespace(categories=[]) %}
    {% for offer in offers %}
    {% if offer.company.industry %}
    {% set category_name = offer.company.industry %}
    {% if category_name not in ns.categories %}
    {% set _ = ns.categories.append(category_name) %}
    {% endif %}
    {% endif %}
    {% endfor %}
    <button class="offers-filter-trigger" type="button" data-filter-trigger
        data-categories='{{ ns.categories | tojson | e }}'>
        <i class="fa-solid fa-sliders"></i>
        <span>تصفية حسب التصنيف</span>
    </button>
    {% endif %}
</section>
<section class="offers-body">
    {% if offers %}
    <div class="offers-grid" role="list">
        {% for offer in offers %}
        {% set runtime = offer_runtime_flags.get(offer.id, {}) %}
        {{ render_offer_card(offer, show_runtime_status=True, runtime_flags=runtime) }}
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <p>لا توجد عروض متاحة حالياً. سيتم إعلامك فور توفر عروض جديدة.</p>
    </div>
    {% endif %}
</section>
{% endblock %}