<!-- LINKED: Standardized conditional access checks across templates using current_user-based logic. -->
<!-- FIXED: Mobile-First User Portal Design (Member-Only) -->
{% extends 'members/portal/base.html' %}
{% block title %}الرئيسية · ELITE{% endblock %}
{% block page_heading %}الرئيسية{% endblock %}
{% block content %}
    <section class="home-hero">
        <div class="home-hero__header">
            <div class="home-hero__logo" aria-hidden="true"><i class="fa-solid fa-crown"></i></div>
        </div>
        <div>
            <h1 class="home-hero__title">
                {% if current_user.is_authenticated %}
                    مرحباً {{ current_user.username }}
                {% else %}
                    مرحباً بك في ELITE
                {% endif %}
            </h1>
            <p class="home-hero__text">
                {% if current_user.is_authenticated %}
                    تابع أحدث العروض المتاحة واجمع نقاطك بسهولة من الهاتف.
                {% else %}
                    قم بتسجيل الدخول لمزامنة نشاطك والوصول إلى أفضل العروض المصممة للأعضاء.
                {% endif %}
            </p>
        </div>
        <div class="home-hero__actions">
            <a class="home-hero__cta" href="{{ url_for('portal.member_portal_offers') }}" data-nav-link data-nav-target="offers">استكشف العروض</a>
            <a class="home-hero__secondary" href="{{ url_for('portal.member_portal_profile') }}" data-nav-link data-nav-target="profile">عرض الملف</a>
        </div>
    </section>
    <section class="home-section">
        <div class="section-headline">
            <h2 class="section-headline__title">عروض مختارة</h2>
            <button
                class="section-headline__link"
                type="button"
                data-nav-link
                data-nav-target="offers"
                data-route="{{ url_for('portal.member_portal_offers') }}"
            >
                عرض الكل
            </button>
        </div>
        <div class="featured-carousel" data-featured-carousel>
            <div class="featured-carousel__track" data-featured-track>
                {% set featured_offers = featured_offers | default([]) %}
                {% if featured_offers %}
                    {% for offer in featured_offers %}
                        {% set discount_value = '%.0f'|format(offer.base_discount) %}
                        <article
                            class="offer-chip"
                            data-offer-id="{{ offer.id }}"
                            data-offer-title="{{ offer.title }}"
                            data-offer-company="{{ offer.company.name if offer.company else 'شريك ELITE' }}"
                            data-offer-discount="{{ discount_value }}"
                            data-offer-valid="{{ offer.valid_until.strftime('%Y-%m-%d') if offer.valid_until else 'مستمر' }}"
                        >
                            <div class="offer-chip__level">TODO: Incentives will be calculated based on verified usage.</div>
                            <h3 class="offer-chip__title">{{ offer.title }}</h3>
                            <p class="offer-chip__company">{{ offer.company.name if offer.company else 'عرض حصري' }}</p>
                            <span class="offer-chip__discount">{{ discount_value }}%</span>
                        </article>
                    {% endfor %}
                {% else %}
                    <article class="offer-chip offer-chip--placeholder" data-featured-placeholder>
                        <h3 class="offer-chip__title">سنقترح عروضاً بمجرد تسجيل الدخول</h3>
                        <p class="offer-chip__company">تابعنا يومياً للحصول على تحديثات جديدة.</p>
                    </article>
                {% endif %}
            </div>
        </div>
    </section>
    <section class="home-section">
        <h2 class="section-headline__title">المكافآت</h2>
        <p class="text-muted">TODO: Incentives will be calculated based on verified usage.</p>
    </section>
{% endblock %}
